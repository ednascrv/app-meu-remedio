<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Meu Rem√©dio</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00796b">
<link rel="icon" href="icon-192.png" sizes="192x192">

<!-- Apple PWA meta -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="icon-512.png">

<style>
:root{
  --blue1:#005580; --green1:#388e3c; --accent:#00695c; --bg:#ffffff; --card-shadow:0 6px 18px rgba(0,0,0,0.12);
}
*{box-sizing:border-box}
body{margin:0;font-family:Arial,sans-serif;background:var(--bg);color:var(--accent);-webkit-font-smoothing:antialiased;}
header{background:linear-gradient(90deg,var(--blue1), var(--green1));color:white;padding:22px 16px;text-align:center;font-size:22px;font-weight:700;border-bottom-left-radius:18px;border-bottom-right-radius:18px;}
.app{padding:16px;padding-bottom:100px;max-width:720px;margin:0 auto;}
.btn-primary{width:100%;display:flex;align-items:center;justify-content:center;gap:10px;padding:16px;font-size:18px;font-weight:700;border-radius:12px;border:none;color:white;background:linear-gradient(90deg,var(--blue1),var(--green1));box-shadow: var(--card-shadow);cursor:pointer;margin-bottom:8px;}
.btn-small{padding:8px 12px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--blue1),var(--green1));color:white;font-weight:700;cursor:pointer;}
.row{display:flex; gap:12px; align-items:center;}
.card{background:#f8fafc; border-radius:12px; padding:12px; box-shadow: var(--card-shadow); margin-top:12px;}
.pill-img{width:64px;height:64px;border-radius:10px;object-fit:cover;border:2px solid rgba(2,136,209,0.12); background:#fff}
table{width:100%;border-collapse:collapse;margin-top:12px;font-size:15px}
th,td{padding:8px;border-bottom:1px solid #e6f0f7;text-align:left}
th{color:#012b48;font-weight:700}
footer{position:fixed; left:0; right:0; bottom:0; height:64px; background: linear-gradient(90deg,var(--blue1), var(--green1)); display:flex; align-items:center; justify-content:center; color:white; font-weight:700; border-top-left-radius:12px;border-top-right-radius:12px;}
.modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.4); z-index:9999;}
.modal.open{display:flex;}
.modal-content{width:94%; max-width:520px; background:white; border-radius:12px; padding:14px;}
.form-row{margin-bottom:8px}
label{display:block; font-size:14px; margin-bottom:6px}
input[type="text"], input[type="time"], textarea, select, input[type="file"], input[type="number"], input[type="date"]{width:100%; padding:10px; border-radius:8px; border:1px solid #d8eefb;}
.history-list{max-height:300px; overflow:auto; padding:6px}
.history-item{padding:10px;border-radius:8px;background:#f6fdff;margin-bottom:8px;font-size:14px}
.flex-space{display:flex; justify-content:space-between; align-items:center}
@media(min-width:680px){ .app{padding:24px} }
small{display:block;margin-top:6px}
.access-row{display:flex;gap:8px;align-items:center;margin-top:8px}
.switch{display:inline-flex;align-items:center;gap:8px}
</style>
</head>
<body>
<header>üíä Meu Rem√©dio</header>
<div class="app" role="main">
  <button id="btnManual" class="btn-primary" aria-label="Adicionar medicamento manualmente">‚úèÔ∏è Adicionar medicamento manualmente</button>
  <button id="btnAdd" class="btn-primary" aria-label="Adicionar receita via OCR">üì∏ Adicionar receita (OCR)</button>
  <button id="btnOCRRemedio" class="btn-primary" aria-label="Adicionar rem√©dio via OCR">üì∑ Adicionar rem√©dio (OCR)</button>
  <button id="btnVoz" class="btn-primary" aria-label="Comando de voz">üéôÔ∏è Comando de voz</button>
  <button id="btnAlarm" class="btn-primary" aria-label="Abrir alarme do dispositivo">‚è∞ Abrir alarme do dispositivo</button>
  <input id="inpFotoOCR" type="file" accept="image/*" capture="environment" style="display:none;">

  <div class="card" aria-label="Acessibilidade">
    <div class="flex-space">
      <h2>Acessibilidade</h2>
      <div class="access-row">
        <label class="switch"><input id="toggleFala" type="checkbox" checked> Falar (voz ativa)</label>
        <label class="switch"><input id="toggleVerboso" type="checkbox"> Verbose (ler lista agenda/hist√≥rico ao abrir)</label>
      </div>
    </div>
  </div>

  <div id="modalForm" class="modal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true">
      <h2>Adicionar Medicamento</h2>
      <div class="form-row"><label for="inputPaciente">Nome do Paciente</label><input type="text" id="inputPaciente" autocomplete="name"></div>
      <div class="form-row"><label for="inputNome">Nome do Medicamento</label><input type="text" id="inputNome"></div>
      <div class="form-row"><label for="inputInstrucao">Instru√ß√£o</label><input type="text" id="inputInstrucao" placeholder="Ex: a cada 8h ou 1x ao dia"></div>
      <div class="form-row"><label for="inputHora">Hora Inicial</label><input type="time" id="inputHora"></div>
      <div class="form-row"><label for="inputFoto">Foto do Medicamento</label><input type="file" id="inputFoto" accept="image/*"></div>
      <div class="row" style="justify-content:flex-end; margin-top:8px;">
        <button id="btnCancelar" class="btn-small" style="background:transparent;color:var(--accent);border:1px solid #d8eefb;" aria-label="Cancelar">Cancelar</button>
        <button id="btnSalvar" class="btn-small" aria-label="Salvar medicamento">Salvar</button>
      </div>
    </div>
  </div>

  <div class="card" aria-label="Lista de medicamentos">
    <div class="flex-space">
      <h2>Lista de medicamentos</h2>
      <div style="display:flex;gap:8px">
        <button id="btnExport" class="btn-small" aria-label="Exportar JSON">Exportar JSON</button>
        <button id="btnImport"
